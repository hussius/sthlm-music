---
phase: 04-crawler-expansion-coverage-enhancement
plan: 02
type: execute
wave: 2
depends_on: [04-01]
files_modified:
  - crawl-tickster.js
  - crawl-all.js
  - client/src/components/FilterBar.tsx
autonomous: false
requirements:
  - "TICKSTER_API_KEY set in .env.local (applied for, pending)"

must_haves:
  truths:
    - "Tickster API client fetches Stockholm music events"
    - "Events upserted to database with sourcePlatform='tickster'"
    - "Crawler handles pagination and rate limiting"
  artifacts:
    - path: "crawl-tickster.js"
      provides: "Tickster API crawler for Stockholm music events"
---

<objective>
Integrate the Tickster API to fetch Stockholm music events from Sweden's main ticketing platform.
Requires TICKSTER_API_KEY (applied for, pending). Follow the same crawl-*.js pattern as other crawlers.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@crawl-all.js
@crawl-stampen.js
</context>

<user_setup>
  - service: Tickster
    why: "Swedish event ticketing platform API"
    env_vars:
      - name: TICKSTER_API_KEY
        source: "Tickster Developer Portal — key already applied for"
</user_setup>

<tasks>

<task type="auto">
  <name>Research Tickster API and create crawler</name>
  <files>crawl-tickster.js</files>
  <action>
    Check Tickster API v0.4 docs. Create crawl-tickster.js following the crawl-*.js pattern:
    - dotenv → postgres → drizzle → fetch Tickster API → upsert events
    - Filter for Stockholm events
    - Handle pagination
    - Map response fields to the events schema (name, artist, venue, date, time, genre, ticketSources, sourceId, sourcePlatform)
    - Set sourcePlatform: 'tickster'
    - Use TICKSTER_API_KEY from process.env

    Follow same upsert pattern as other crawlers:
    db.insert(schema.events).values(event).onConflictDoUpdate({
      target: [schema.events.venue, schema.events.date],
      set: event,
    })
  </action>
  <done>crawl-tickster.js fetches and saves Stockholm events from Tickster API.</done>
</task>

<task type="auto">
  <name>Wire into crawl-all.js</name>
  <files>crawl-all.js</files>
  <action>
    Add { name: 'Tickster', file: './crawl-tickster.js' } to the crawlers array.
  </action>
  <done>crawl-all.js runs Tickster crawler.</done>
</task>

</tasks>

<success_criteria>
1. crawl-tickster.js fetches Stockholm events from Tickster API
2. Events saved with sourcePlatform='tickster'
3. Handles pagination and rate limits gracefully
4. Integrated in crawl-all.js
</success_criteria>

<output>
After completion, create `.planning/phases/04-crawler-expansion-coverage-enhancement/04-02-SUMMARY.md`

Note: Blocked until TICKSTER_API_KEY arrives.
</output>
