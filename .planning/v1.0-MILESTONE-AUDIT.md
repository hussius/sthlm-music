---
milestone: v1.0
audited: 2026-02-25T00:00:00Z
status: gaps_found
scores:
  requirements: 11/22
  phases: 3/3
  integration: 7/14
  flows: 1/5
gaps:
  requirements:
    - id: "DATA-05"
      status: "unsatisfied"
      phase: "Phase 1"
      claimed_by_plans: ["01-07-PLAN.md", "01-09-PLAN.md"]
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "deduplicateAndSave() in deduplicator.ts has 0 import sites outside its own module. All crawlers call upsertEvent() directly, bypassing the 3-stage fuzzy deduplication pipeline entirely."
    - id: "QUAL-01"
      status: "unsatisfied"
      phase: "Phase 1"
      claimed_by_plans: ["01-07-PLAN.md"]
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Fuzzy deduplication pipeline (deduplicator.ts) is built but never invoked. Only the DB unique constraint on (venue, date) is active. Cross-platform duplicate merging via fuzzy matching is not happening."
    - id: "DATA-06"
      status: "unsatisfied"
      phase: "Phase 1"
      claimed_by_plans: ["01-01-PLAN.md"]
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "setupCleanupJob() in jobs.ts has 0 call sites. The cleanup job is defined but never scheduled. src/index.ts starts only the Fastify server — no BullMQ worker or job setup."
    - id: "DATA-01"
      status: "partial"
      phase: "Phase 1"
      claimed_by_plans: ["01-03-PLAN.md"]
      completed_by_plans: []
      verification_status: "passed"
      evidence: "Crawler exists (src/crawlers/ticketmaster.ts) and Phase 1 VERIFICATION.md reports it satisfied. However, setupCrawlJobs() is never called from src/index.ts — the scheduling worker never starts, so crawls never execute automatically."
    - id: "DATA-02"
      status: "partial"
      phase: "Phase 1"
      claimed_by_plans: ["01-04-PLAN.md"]
      completed_by_plans: []
      verification_status: "passed"
      evidence: "Crawler exists (src/crawlers/axs.ts, 375 lines). Scheduling worker never started — same root cause as DATA-01."
    - id: "DATA-03"
      status: "partial"
      phase: "Phase 1"
      claimed_by_plans: ["01-05-PLAN.md"]
      completed_by_plans: []
      verification_status: "passed"
      evidence: "Crawler exists (src/crawlers/dice.ts, 7568 bytes). Scheduling worker never started."
    - id: "DATA-04"
      status: "partial"
      phase: "Phase 1"
      claimed_by_plans: ["01-06-PLAN.md"]
      completed_by_plans: []
      verification_status: "passed"
      evidence: "13 venue crawlers exist in src/crawlers/venues/. Scheduling worker never started."
    - id: "FILT-02"
      status: "partial"
      phase: "Phase 2 + Phase 3"
      claimed_by_plans: ["02-02-PLAN.md", "02-03-PLAN.md", "03-03-PLAN.md"]
      completed_by_plans: ["02-02-SUMMARY.md", "02-03-SUMMARY.md"]
      verification_status: "passed"
      evidence: "API layer and DB query fully wired. FilterBar genre select is commented out (client/src/components/FilterBar.tsx lines 93–109) with note '{/* Genre Filter - Hidden */}'. User cannot set a genre filter in the live UI."
    - id: "FILT-03"
      status: "partial"
      phase: "Phase 2 + Phase 3"
      claimed_by_plans: ["02-02-PLAN.md", "02-03-PLAN.md", "03-03-PLAN.md"]
      completed_by_plans: ["02-02-SUMMARY.md", "02-03-SUMMARY.md"]
      verification_status: "passed"
      evidence: "API layer wired. FilterBar has 24 venue options but 11 have no matching crawlers or canonical names. 'Pet Sounds' filter value != canonical 'Pet Sounds Bar'. 'Debaser Nova'/'Debaser Strand' != canonical 'Debaser'. Selecting these options returns 0 results."
    - id: "DISP-02"
      status: "partial"
      phase: "Phase 3"
      claimed_by_plans: ["03-02-PLAN.md"]
      completed_by_plans: []
      verification_status: "passed"
      evidence: "EventCard renders name/date/venue/time. Artist and genre only rendered in EventModal which is disabled (EventList.tsx line 108: '{/* Modal disabled for now */}', EventModal has 0 import sites)."
    - id: "DISP-03"
      status: "partial"
      phase: "Phase 3"
      claimed_by_plans: ["03-02-PLAN.md"]
      completed_by_plans: []
      verification_status: "passed"
      evidence: "EventCard renders a ticket link if ticketSources[0] exists (implicit availability). No explicit ticket availability status label rendered. Full ticketSources list only in disabled EventModal."
  integration:
    - issue: "Deduplication pipeline wired but never called"
      affected_requirements: ["DATA-05", "QUAL-01"]
      severity: "critical"
      detail: "deduplicateAndSave() and saveEventWithDeduplication() in src/deduplication/deduplicator.ts have 0 import sites outside the module. All crawlers use upsertEvent() directly."
    - issue: "Scheduling never started — crawlers don't run automatically"
      affected_requirements: ["DATA-01", "DATA-02", "DATA-03", "DATA-04", "DATA-06"]
      severity: "critical"
      detail: "setupCrawlJobs(), setupCleanupJob(), and createWorker() are defined but never called. src/index.ts starts only the API server."
    - issue: "EventModal disabled — artist/genre/price/full ticket sources not visible"
      affected_requirements: ["DISP-02", "DISP-03"]
      severity: "critical"
      detail: "EventModal exists at client/src/components/EventModal.tsx but is never imported or mounted. EventList.tsx line 108 has '{/* Modal disabled for now */}'."
    - issue: "FilterBar genre select commented out"
      affected_requirements: ["FILT-02"]
      severity: "critical"
      detail: "FilterBar.tsx lines 93–109 are commented out: '{/* Genre Filter - Hidden (not useful with current data) */}'"
    - issue: "FilterBar venue options mismatched — 11 dead, 2 canonical mismatches"
      affected_requirements: ["FILT-03"]
      severity: "critical"
      detail: "24 venue options in FilterBar, only ~11 have matching Phase 1 crawlers. 'Pet Sounds' != canonical 'Pet Sounds Bar'. 'Debaser Nova/Strand' != canonical 'Debaser'."
  flows:
    - flow: "Genre filter: select genre → API → results"
      status: "broken"
      breaks_at: "FilterBar genre select commented out — user cannot initiate this flow"
      affected_requirements: ["FILT-02"]
    - flow: "View event details: artist, genre, ticket availability"
      status: "broken"
      breaks_at: "EventModal disabled — modal never opens, details never shown"
      affected_requirements: ["DISP-02", "DISP-03"]
    - flow: "Automated daily crawl → fresh events in calendar"
      status: "broken"
      breaks_at: "Scheduling worker never started — no automatic crawl execution"
      affected_requirements: ["DATA-01", "DATA-02", "DATA-03", "DATA-04"]
    - flow: "12-month window cleanup"
      status: "broken"
      breaks_at: "Cleanup job never scheduled"
      affected_requirements: ["DATA-06"]
tech_debt:
  - phase: "01-data-foundation-multi-platform-aggregation"
    items:
      - "monitoring.ts:150 — TODO for production alerting (console only, no Slack/email)"
      - "Plans 01-03 and 01-08 are missing SUMMARY.md files"
      - "All plan SUMMARY.md files lack requirements-completed frontmatter"
  - phase: "02-api-layer-performance"
    items:
      - "autocannon package not installed — load test script cannot run"
      - "Port mismatch: server defaults to :3000, client fallback targets :3001 — only aligned by .env.local"
      - "CORS origin default is 'http://localhost:3000' — needs CORS_ORIGIN env var in production"
  - phase: "03-calendar-ui-public-launch"
    items:
      - "Debug pagination banner (bg-yellow-100 div) exposed to end users in EventList.tsx:99"
      - "All phase SUMMARY.md files lack requirements-completed frontmatter"
---

# Milestone v1.0 Audit Report

**Milestone:** v1.0 Stockholm Music Events Calendar
**Audited:** 2026-02-25
**Status:** ⚠ gaps_found
**Phases in scope:** 1–3

## Scores

| Dimension | Score | Notes |
|-----------|-------|-------|
| Requirements | 11/22 | 11 wired, 8 partial, 3 unsatisfied |
| Phases | 3/3 | All phase VERIFICATION.md present |
| Integration | 7/14 | Crawler-to-schedule wiring broken, dedup pipeline orphaned |
| E2E flows | 1/5 | Only date/artist/event-name filter → results works end-to-end |

## Phase Verification Summary

| Phase | VERIFICATION.md | Status | Score |
|-------|----------------|--------|-------|
| Phase 1: Data Foundation | ✓ Present | passed (re-verified) | 5/5 success criteria |
| Phase 2: API Layer | ✓ Present | human_needed | 8/9 truths (perf needs live test) |
| Phase 3: Calendar UI | ✓ Present | passed | 16/16 truths |

**Note:** Phase 1 disk status is `partial` — plans 01-03 and 01-08 are missing SUMMARY.md files.

## Requirements Coverage

### Satisfied (11/22)

| REQ-ID | Description | Evidence |
|--------|-------------|----------|
| DATA-07 | Normalize to common schema | Transformers + venue/genre mappings wired throughout |
| FILT-01 | Filter by date range | FilterBar dateFrom/dateTo → API gte/lte — fully wired |
| FILT-04 | Search by artist name | Debounced input → API ilike with GIN trigram index |
| FILT-05 | Search by event name | Same pattern as FILT-04 |
| PERF-01 | Sub-200ms response times | Infrastructure in place (response-time middleware, GIN indexes) |
| PERF-02 | No degradation with 10k+ events | Cursor pagination + B-tree indexes |
| DISP-01 | Chronological list view | EventList + orderBy(asc(events.date)) in repository |
| DISP-04 | Mobile responsive | Mobile-first Tailwind layout |
| DISP-05 | Stockholm timezone | formatInTimeZone(STOCKHOLM_TZ) in EventCard and EventModal |
| INTG-01 | Click through to ticket platform | EventCard ticket link with target="_blank" |
| INTG-02 | Deep links | ticketSources[].url from crawlers are event-specific URLs |

### Partial (8/22)

| REQ-ID | Description | Gap |
|--------|-------------|-----|
| DATA-01 | Crawl Ticketmaster SE daily | Crawler exists; scheduling worker never started |
| DATA-02 | Crawl AXS/Live Nation daily | Crawler exists; scheduling worker never started |
| DATA-03 | Crawl DICE daily | Crawler exists; scheduling worker never started |
| DATA-04 | Crawl 13 priority venues | Crawlers exist; scheduling worker never started |
| FILT-02 | Filter by genre | API wired; genre select commented out in FilterBar |
| FILT-03 | Filter by venue | API wired; 11/24 options dead, 2 canonical mismatches |
| DISP-02 | Show artist, genre, all details | EventCard shows name/date/venue; EventModal disabled |
| DISP-03 | Ticket availability status | Implicit link only; no explicit availability label |

### Unsatisfied (3/22)

| REQ-ID | Description | Gap |
|--------|-------------|-----|
| DATA-05 | Deduplicate events across sources | Deduplication pipeline built but never called; only DB unique constraint active |
| DATA-06 | 12-month rolling window cleanup | Cleanup job defined but never scheduled |
| QUAL-01 | >95% deduplication accuracy | Fuzzy match stage never invoked |

## Critical Integration Gaps

### 1. Scheduling Worker Never Started
**Affects:** DATA-01, DATA-02, DATA-03, DATA-04, DATA-06

`src/index.ts` starts only the Fastify API server. `setupCrawlJobs()`, `setupCleanupJob()`, and `createWorker()` are defined in `src/scheduling/jobs.ts` and `src/scheduling/processors.ts` but have zero call sites outside their own modules.

**Impact:** The application cannot crawl any platform automatically. Events only enter the database if crawlers are run manually.

### 2. Deduplication Pipeline Orphaned
**Affects:** DATA-05, QUAL-01

`deduplicateAndSave()` in `src/deduplication/deduplicator.ts` is built and tested by VERIFICATION but is never called by any crawler. All crawlers bypass it and call `upsertEvent()` directly. Only the database-level `(venue, date)` unique constraint prevents exact duplicates — the 3-stage fuzzy deduplication that handles cross-platform matches is inactive.

### 3. EventModal Disabled
**Affects:** DISP-02, DISP-03

`EventList.tsx:108` has `{/* Modal disabled for now */}`. The `EventModal` component (which renders artist, genre, price, full ticket sources) has 0 import sites. Users cannot see genre or artist for any event.

### 4. Genre Filter Commented Out
**Affects:** FILT-02

`FilterBar.tsx:93–109` is commented out with note: `{/* Genre Filter - Hidden (not useful with current data) */}`. FILT-02 cannot be exercised by any user.

### 5. Venue Filter Options Mismatched
**Affects:** FILT-03

- 11 of 24 FilterBar venue options have no corresponding crawlers
- `"Pet Sounds"` does not match canonical `"Pet Sounds Bar"` — always returns 0 results
- `"Debaser Nova"` / `"Debaser Strand"` do not match canonical `"Debaser"` — always return 0 results
- 4 Phase 1 venues (Slakthuset, Landet, Mosebacke, Kägelbanan) are crawled but missing from FilterBar

## E2E Flows

| Flow | Status | Breaks At |
|------|--------|-----------|
| Date filter → API → results | ✓ Complete | — |
| Artist/event name search → results | ✓ Complete | — |
| Genre filter → results | ✗ Broken | FilterBar genre select commented out |
| View full event details (artist, genre) | ✗ Broken | EventModal never mounted |
| Automated daily crawl → calendar refreshed | ✗ Broken | Scheduling worker never started |
| 12-month cleanup run | ✗ Broken | Cleanup job never scheduled |

## Tech Debt (Non-Critical)

| Phase | Item | Severity |
|-------|------|----------|
| Phase 1 | monitoring.ts:150 — console-only alerting (TODO: Slack/email) | Info |
| Phase 1 | Plans 01-03 and 01-08 missing SUMMARY.md files | Warning |
| Phase 2 | `autocannon` not installed — load test cannot run | Warning |
| Phase 2 | Port mismatch: server :3000 / client fallback :3001 — only resolved by .env.local | Warning |
| Phase 2 | CORS origin defaults to localhost:3000 — needs env var in production | Warning |
| Phase 3 | Debug pagination banner (bg-yellow-100) visible to end users | Warning |
| All | SUMMARY.md files lack `requirements-completed` frontmatter | Info |

## Next Steps

**Status is `gaps_found`** — critical blockers prevent milestone completion.

Recommended actions:
1. **Wire scheduling worker into entry point** — call `setupCrawlJobs()` + `setupCleanupJob()` + `createWorker()` in `src/index.ts` (or a separate worker entry point). Closes DATA-01 through DATA-04, DATA-06.
2. **Wire deduplication pipeline** — crawlers should call `deduplicateAndSave()` instead of `upsertEvent()` directly. Closes DATA-05, QUAL-01.
3. **Enable EventModal** — import and mount `EventModal` in `EventList.tsx`. Closes DISP-02, DISP-03.
4. **Restore genre filter** — uncomment genre select in `FilterBar.tsx`. Closes FILT-02.
5. **Fix venue filter options** — align FilterBar venue options with Phase 1 canonical names. Closes FILT-03 (partially).

Use `/gsd:plan-milestone-gaps` to create a gap-closure phase, or `/gsd:complete-milestone v1.0` to accept these as known gaps.

---

_Audited: 2026-02-25_
_Auditor: Claude (gsd-auditor)_
